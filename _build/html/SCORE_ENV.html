
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SCORE Tutorial &#8212; loopchain Docs 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="Local computer에서 SCORE 개발할 수 있는 환경 만들기" href="SCORE_local_DEV_env.html" />
    <link rel="prev" title="설정 가이드" href="Configuration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="score-tutorial">
<span id="score-tutorial"></span><h1>SCORE Tutorial<a class="headerlink" href="#score-tutorial" title="제목 주소">¶</a></h1>
<div class="section" id="">
<span id="id1"></span><h2>목적<a class="headerlink" href="#" title="제목 주소">¶</a></h2>
<p>이 Tutorial에서는 사용자의 컴퓨터에서 Docker로 loopchain을 실행하면서 Github에 있는 SCORE를 사용하는 것을 실습하여 봅니다.</p>
</div>
<div class="section" id="score">
<span id="score"></span><h2>SCORE 저장소 생성<a class="headerlink" href="#score" title="제목 주소">¶</a></h2>
<div class="section" id="github-score-sample-fork">
<span id="github-score-sample-fork"></span><h3>1. GitHub에서 SCORE sample을 fork 해오기<a class="headerlink" href="#github-score-sample-fork" title="제목 주소">¶</a></h3>
<p>GitHub에서 SCORE Sample 프로젝트(https://github.com/theloopkr/contract_sample) 를 자신의 계정으로 fork 하여서 SCORE 개발 환경을 위한 테스트용 SCORE 저장소를 생성합니다.
<img alt="github" src="_images/github_contract-sample.png" /></p>
<ul class="simple">
<li>SCORE 프로젝트는 2개의 파일로 구성됩니다.<ul>
<li>package.json</li>
<li>SCORE code (*.py 파일)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="score-ssh-ssh">
<span id="score-ssh-ssh"></span><h3>2. SCORE 저장소와 SSH통신을 위해 SSH키를 생성하기<a class="headerlink" href="#score-ssh-ssh" title="제목 주소">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ssh-keygen</span></code>명령어를 사용하셔서 <code class="docutils literal notranslate"><span class="pre">id_tutorial</span></code>이라는 이름으로 생성합니다.</p>
<p>아래 화면을 참고하시고 GitHub의 자신의 이메일주소로 SSH키를 생성하셔야 합니다.</p>
<p>상세한 내용은 <a class="reference external" href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/">외부 링크</a>를 참고해주세요. 만약 Sierra 10.12.2 혹은 그 이후의 MacOS를 사용하시는 분들은 링크의 내용을 참고하셔서 추가적으로 진행하셔야 하는 내용이 있으니 꼭 확인하시고 따라 하십시오.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/{user_id}/.ssh/id_rsa): /Users/{user_id}/.ssh/id_tutorial
......

$ ls -la ~/.ssh/ | grep id_tutorial
-rw-------   1 donghanlee  staff  1679  3  7 09:45 id_tutorial
-rw-r--r--   1 donghanlee  staff   420  3  7 09:45 id_tutorial.pub
</pre></div>
</div>
</div>
<div class="section" id="github-deployment-key">
<span id="github-deployment-key"></span><h3>3. GitHub에 Deployment key를 등록하기<a class="headerlink" href="#github-deployment-key" title="제목 주소">¶</a></h3>
<p>앞서 Fork를 뜬 SCORE 저장소에 SSH public key 내용을 (예:id_tutorial.pub)를 등록합니다.</p>
<ul class="simple">
<li>Public key의 내용을 확인합니다.</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat .ssh/id_tutorial.pub
ssh-rsa
......YOUR_PUBLIC_KEY........
== your_email@example.com
</pre></div>
</div>
<ul class="simple">
<li>Public key의 내용을 아래처럼 Fork한 SCORE package의 deployment key로 등록합니다.
<img alt="ssh public key" src="_images/github_add_sshkey.png" /></li>
</ul>
</div>
</div>
<div class="section" id="">
<span id="id2"></span><h2>환경설정<a class="headerlink" href="#" title="제목 주소">¶</a></h2>
<p><a class="reference external" href="Tutorial_1R1P.md"><code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">computer에서</span> <span class="pre">RadioStation과</span> <span class="pre">1개의</span> <span class="pre">Peer로</span> <span class="pre">Blockchain</span> <span class="pre">network</span> <span class="pre">구성하기</span></code></a> 내용을 기반으로 SCORE 환경설정을 하겠습니다. 해당 파일과 디렉토리를 복사하여서 다른 디렉토리로 만들고 아래 내용대로 추가 하거나 수정합니다.</p>
<div class="section" id="radiostation-score">
<span id="radiostation-score"></span><h3>1. RadioStation 설정 -   SCORE 저장소 경로 설정<a class="headerlink" href="#radiostation-score" title="제목 주소">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">channel_manage_data.json</span></code>을 열어서 <code class="docutils literal notranslate"><span class="pre">score_package</span></code>의 값으로 <code class="docutils literal notranslate"><span class="pre">&quot;{your_github_id}/contract_sample&quot;</span></code>라고 수정합니다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">channel_manage_data.json</span></code></strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;channel1&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;score_package&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{your_github_id}</span><span class="s2">/contract_sample&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="start-sh-peer">
<span id="start-sh-peer"></span><h3>2.  시작 스크립트인 start.sh 스크립트의 peer 부분을 수정<a class="headerlink" href="#start-sh-peer" title="제목 주소">¶</a></h3>
<ol class="simple">
<li>환경변수 추가 등록 <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">SSH_KEY_FOLDER=/Users/{user_id}/.ssh/id_tutorial</span></code></li>
<li>SSH key 경로설정 <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">${SSH_KEY_FOLDER}:/root/.ssh/id_rsa</span></code></li>
<li>SCORE 저장소 도메인 설정 <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">&quot;DEFAULT_SCORE_HOST=github.com&quot;</span></code></li>
</ol>
<p><strong>변경된  <code class="docutils literal notranslate"><span class="pre">start.sh</span></code>파일 내용</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```
##############################################
#           환경변수등록
##############################################
export SSH_KEY_FOLDER=/Users/{user_id}/.ssh/id_tutorial

##############################################
#           Peer0 실행
##############################################
docker run -d --name peer0 \
.....
-v ${SSH_KEY_FOLDER}:/root/.ssh/id_rsa \
-e &quot;DEFAULT_SCORE_HOST=github.com&quot; \
.....

```
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id3"></span><h2>환경 설정 확인<a class="headerlink" href="#" title="제목 주소">¶</a></h2>
<p>1.loopchain 도커 컨테이너를 모두 실행: <strong>start.sh</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./start.sh
</pre></div>
</div>
<p>2.peer 목록 조회</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9002/api/v1/peer/list | python -m json.tool
{
    &quot;data&quot;: {
        &quot;connected_peer_count&quot;: 2,
        &quot;connected_peer_list&quot;: [
            {
              .......
            },
            {
              .......
            }
        ],
        &quot;registered_peer_count&quot;: 2,
        &quot;registered_peer_list&quot;: [
            {
              .......
            },
            {
              .......
            }
        ]
    },
    &quot;response_code&quot;: 0
  }
</pre></div>
</div>
<ul class="simple">
<li>현재 Blockchain network에 연결된 Peer들을 보여줍니다.</li>
<li><code class="docutils literal notranslate"><span class="pre">connected_peer_count</span></code>와 <code class="docutils literal notranslate"><span class="pre">registered_peer_count</span></code>의 값이 같아야 합니다.</li>
</ul>
<p>3.Peer 상태 조회</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/api/v1/status/peer | python -m json.tool
{
    &quot;audience_count&quot;: &quot;0&quot;,
    &quot;block_height&quot;: 0,
    &quot;consensus&quot;: &quot;siever&quot;,
    &quot;leader_complaint&quot;: 1,
    &quot;made_block_count&quot;: 0,
    &quot;peer_id&quot;: &quot;d0060308-22b2-11e8-b58b-0242ac110004&quot;,
    &quot;peer_target&quot;: &quot;172.17.0.4:7100&quot;,
    &quot;peer_type&quot;: &quot;1&quot;,
    &quot;status&quot;: &quot;Service is online: 1&quot;,
    &quot;total_tx&quot;: 0
}
</pre></div>
</div>
<p>Peer의 block들의 높이, 상태, Tx의 갯수등을 보여줍니다.</p>
<p>4.SCORE 버전 조회</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/api/v1/status/score | python -m json.tool
{
    &quot;all_version&quot;: [
        &quot;f58b8b3e955984a09674a1f74c493001678d706c&quot;,
        &quot;b39064b358b84798f20f024fca066a113ec88b18&quot;,
        &quot;99923ce139350cf8f37ef9f72fddf3f327da4d7a&quot;,
        &quot;e25e2fba404bbc42b010c552d280063c704a0917&quot;,
        &quot;909b1ee00a00f12f744f3d669232c6f4549e945f&quot;,
        &quot;51f258059bcc4f1fa46ba3df8762b953e27fcdee&quot;,
        &quot;359b1f79b8bf2064ce0605d4b081da43a845beda&quot;,
        &quot;3d7195e1e98e38bdddab93fd03ee0c7aa0a20765&quot;,
        &quot;669b6db3a6c085b3de96d7bd13bc19efc26162ae&quot;,
        &quot;5136f28e83e3aaf6fabb0c0556b505ca5b95a44c&quot;,
        &quot;a74476425197c2b2b009a180f24f52efec932da8&quot;,
        &quot;95c0dd33b826c9b529a9f8b6b349e1b002bb9835&quot;,
        &quot;71afe3ca44fa46acced9b12c80ad1951fe83e4bd&quot;,
        &quot;f01986ae06e402a97e48bfddb31d5aeebe1dc07b&quot;,
        &quot;99ece33bb62b8b1c61182d074351b5062311d2f5&quot;,
        &quot;eabe94b94545faac1c8951fb31ef62a9f549cc5f&quot;,
        &quot;f5aab582d9f390f5378daf08f54d08c071f15d0c&quot;,
        &quot;f79c480fc7af6d02c79e1fe3191bbc471962166f&quot;,
        &quot;e38140e76766f2e51f30858a0ee3c82a90b9c258&quot;,
        &quot;af7c49743fecd315d4e4491751fbdae9b92dead7&quot;,
        &quot;bcc0d0f05d1a219cd4ed47955a86b0e16d1b2778&quot;
    ],
    &quot;id&quot;: &quot;{your_github_id}/contract_sample&quot;,
    &quot;status&quot;: 0,
    &quot;version&quot;: &quot;f58b8b3e955984a09674a1f74c493001678d706c&quot;
}
</pre></div>
</div>
<p>현재 올라온 SCORE의 버전들을 보여줍니다. SCORE는 내부에서 Git으로 버전을 관리하기 때문에 Git상에서 각 버전의 SHA-1 hash를 보여줍니다.</p>
<p>5.SCORE Transaction 생성</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;propose&quot;,&quot;params&quot;:{&quot;proposer&quot;:&quot;RealEstateAgent&quot; , &quot;counterparties&quot;: [&quot;leaseholder&quot;,&quot;jinho&quot;], &quot;content&quot;: &quot;Theloop APT 101-3001, lease for 3 months from 3th April,2018&quot;, &quot;quorum&quot;: &quot;3&quot;}}&#39;  http://localhost:9000/api/v1/transactions | python -m json.tool
  {
    &quot;more_info&quot;: &quot;&quot;,
    &quot;response_code&quot;: &quot;0&quot;,
    &quot;tx_hash&quot;: &quot;7bc856e972da62a6cba3deff71e74e848174fc1e28feaae66f58ff2447875f0a&quot;
}
</pre></div>
</div>
<p>새로운 Transaction을 만들기 위해서, 해당 SCORE의 invoke()아래 구현된 함수를 부릅니다. 이를 위해, 해당 함수를 부를 수 있는 json-rpc 2.0 형태의 JSON을 만들어 부릅니다. 여기서는 <code class="docutils literal notranslate"><span class="pre">propose</span></code>라는 함수를 불러본 것입니다. 이 결과로 Tx의 Hash값을 되돌려줍니다.</p>
<p>6.SCORE Transaction 조회 - <code class="docutils literal notranslate"><span class="pre">tx_hash</span></code> 사용     (7bc856e972da62a6cba3deff71e74e848174fc1e28feaae66f58ff2447875f0a)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/api/v1/transactions/result?hash=7bc856e972da62a6cba3deff71e74e848174fc1e28feaae66f58ff2447875f0a | python -m json.tool
{
      &quot;response&quot;: {
      &quot;code&quot;: 0,
        &quot;jsonrpc&quot;: &quot;2.0&quot;
    },
    &quot;response_code&quot;: &quot;0&quot;
}
</pre></div>
</div>
<p>앞서 만든 Tx의 hash를 가지고 결과를 조회해봅니다. <code class="docutils literal notranslate"><span class="pre">response_code</span></code>가 0면 정상입니다.</p>
<p>7.SCORE Transaction 실행 결과 조회 (Query)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;Content-Type: application/json&quot; -X POST -d &#39;{&quot;jsonrpc&quot;: &quot;2.0&quot;,&quot;channel&quot;:&quot;channel1&quot;,&quot;method&quot;:&quot;get_user_contracts&quot;,&quot;id&quot;:&quot;11233&quot;,&quot;params&quot;:{&quot;user_id&quot;:&quot;jinho&quot;}}&#39; http://localhost:9000/api/v1/query | python -m json.tool
{
    &quot;response&quot;: {
        &quot;code&quot;: 0,
        &quot;id&quot;: &quot;11233&quot;,
        &quot;jsonrpc&quot;: &quot;2.0&quot;,
        &quot;response&quot;: {
            &quot;user_contracts&quot;: [
                {
                    &quot;approvers&quot;: [
                        &quot;RealEstateAgent&quot;
                    ],
                    &quot;content&quot;: &quot;Theloop APT 101-3001, lease for 3 months from 3th April,2018&quot;,
                    &quot;contract_id&quot;: 1,
                    &quot;counterparties&quot;: [
                        &quot;leaseholder&quot;,
                        &quot;jinho&quot;
                    ],
                    &quot;proposer&quot;: &quot;RealEstateAgent&quot;,
                    &quot;quorum&quot;: &quot;3&quot;
                }
            ]
        }
    },
    &quot;response_code&quot;: &quot;0&quot;]
}
</pre></div>
</div>
<p>만들어진 Transaction을 찾기 위해서, 해당 SCORE의 query()아래 구현된 함수를 부릅니다. 이를 위해, 해당 함수를 부를 수 있는 json-rpc 2.0 형태의 JSON을 만들어 부릅니다. 여기서는 <code class="docutils literal notranslate"><span class="pre">user_contracts</span></code> 라는 함수를 불러본 것입니다.</p>
<p>8.peer 상태 조회(block_height, made_block_count,total_tx 변화 확인)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/api/v1/status/peer | python -m json.tool
{
    &quot;audience_count&quot;: &quot;0&quot;,
    &quot;block_height&quot;: 1,
    &quot;consensus&quot;: &quot;siever&quot;,
    &quot;leader_complaint&quot;: 1,
    &quot;made_block_count&quot;: 1,
    &quot;peer_id&quot;: &quot;d0060308-22b2-11e8-b58b-0242ac110004&quot;,
    &quot;peer_target&quot;: &quot;172.17.0.4:7100&quot;,
    &quot;peer_type&quot;: &quot;1&quot;,
    &quot;status&quot;: &quot;Service is online: 1&quot;,
    &quot;total_tx&quot;: 1
}
</pre></div>
</div>
<p>앞에서 만든 Tx로 <code class="docutils literal notranslate"><span class="pre">total_tx</span></code>가 증가된 것을 확인할 수 있습니다.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">목차</a></h3>
  <ul>
<li><a class="reference internal" href="#">SCORE Tutorial</a><ul>
<li><a class="reference internal" href="#">목적</a></li>
<li><a class="reference internal" href="#score">SCORE 저장소 생성</a><ul>
<li><a class="reference internal" href="#github-score-sample-fork">1. GitHub에서 SCORE sample을 fork 해오기</a></li>
<li><a class="reference internal" href="#score-ssh-ssh">2. SCORE 저장소와 SSH통신을 위해 SSH키를 생성하기</a></li>
<li><a class="reference internal" href="#github-deployment-key">3. GitHub에 Deployment key를 등록하기</a></li>
</ul>
</li>
<li><a class="reference internal" href="#">환경설정</a><ul>
<li><a class="reference internal" href="#radiostation-score">1. RadioStation 설정 -   SCORE 저장소 경로 설정</a></li>
<li><a class="reference internal" href="#start-sh-peer">2.  시작 스크립트인 start.sh 스크립트의 peer 부분을 수정</a></li>
</ul>
</li>
<li><a class="reference internal" href="#">환경 설정 확인</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Configuration.html" title="이전 장">설정 가이드</a></li>
      <li>Next: <a href="SCORE_local_DEV_env.html" title="다음 장">Local computer에서 SCORE 개발할 수 있는 환경 만들기</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>현재 문서</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/SCORE_ENV.md.txt"
            rel="nofollow">소스 코드를 보려면</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>빠른 검색</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="바로 가기" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Theloop.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/SCORE_ENV.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>