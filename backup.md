
## Why Private blockchain
비트코인이나 이더리움과 같이 공개된 블록체인 기술은 실제 엔터프라이즈 서비스에 적용하기 부족한 낮은 성능 및 데이터 공개 이슈가 있습니다.  이러한 문제를 해결하기 위해서 R3 Corda와 같은 프라이빗 블록체인이 개발되어지고 있습니다.

프라이빗 블록체인의 특징

* 금융, 공공 등 규제 기반 거래에 적합한 거래방식 지원
* 허가된 사용자들의 합의과정을 통해 거래가 확정되므로 거래 확정의 주체가 명확하다.
* 규제 및 컴플라이언스 요소들을 만족시킬 수 있도록 커스터마이징 가능하게 설계
* 거래의 성격에 따라 합의 알고리즘, 블록생성 주기 등을 최적화하여서 빠른 속도가 필요한 거래에도 활용 가능



## 합의 알고리즘간 비교표
구분|PBFT/Sieve|PoW|PoS
---|---|---|---
통신 비용|각 서버간 통신으로 높음|로컬 통신만으로 비용 낮음|로컬 통신만으로 비용 낮음
결함허용대수|1/3미만까지 보증(정확히 1/3인 경우 대응불가|1대라도 남아있다면 문제 없음|1대라도 남아있으면 문제 없음
다수결 대신이 되는 것|다수결|CPU 계산량|보유한 자산의 크기
CPU 연산비용|낮음|높음|중간 정도, PoW 보다 낮음
권한의 분산|참가 서버 모두가 평등|전기세가 낮은 지역에 집중될 수 있음|일반적으로 화폐 보유는 집중될 가능성 높음
참가 서버의 조건|신뢰된 서버만 참가|어떤 서버도 참가 가능|어떤 서버도 참가 가능
비밀 보호를 위한 인증|사전에 서로 신뢰한 공개 암호화키를 사용|참가시 준비한 공개 암호화 키를 사용|참가시 준비한 공개 암호화 키를 사용


## LFT Normal Case

![LFT Normal Case](images/LFT_Normal_Process.png)

** 이미지 기본 설명**
* 각 수평선은 블록체인 네트워크에 참여하는 노드를 나타내며 화살표는 한 노드가 다른 노드에 보내는 메시지를 의미한다.
* 네트워크 이벤트의 순서는 왼쪽에서 오른쪽으로 일어난다. 따라서 왼쪽에서 일어난 이벤트가 오른쪽에서 일어난 이벤트보다 먼저 일어난 이벤트이다.
* 가장 밑의 평행성은 기간에 따른 리더를 표시하고 있다.

**LFT 합의순서**
1. 합의가 시작되면 검증 노드들은 리더 노드에 처리하기 원하는 트랜잭션을 전송한다.
2. 리더 노드는 수집한 트랜잭션을 이용하여 블록을 생성하고 자신의 서명과 함께 다른 모든 검증 노드에 전송한다.(Broadcast Block)
3. 각 검증 노드들은 블록을 받으면 다음의 순서로 검증한다.
  1. 현재 리더가 블록을 생성했는지 확인한다.
  2. 블록의 높이와 이전 블록 해시가 올바른지 확인한다.
  3. 블록의 메세지가 올바른지 확인한다.(Verify block).
  4. 검증 노드는 검증 결과에 따라 투표 메시지를 모든 노드들에게 보낸다(Broadcast Vote)
  5. 각 노드가 정족수 이상의 투표를 받게 되면 해당 높이의 블록을 자신의 블록체인에 추가한다(Count Vote). 리더 노드는 정족수 이상의 투표를 받으면 해당 높이의 블록생성을 성공으로 취급하고 다른 노드에서 받은 트랜잭션을 모아 새로운 높이의 블록을 생성하고 다른 모든 피어에 새로운 높이의 블록 메시지를 보낸다.



생성된 블록이 제니시스 블록이 아닌 경우 검증 노드들은 블록에 포함된 이전 블록 투표 검증 메시지들이 올바른지 검증한다.
같은 블록 해시에 대한 투표메시지가 정족수 이상 포함되어 있는지 검증한다.
투표 메시지 공유시 정족수 이상의 투표를 받지 못한 노드도 이전 블록을 자신의 블록체인에 추가할수 있다.
